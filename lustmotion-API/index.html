
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../lustmotion-connectivity/">
      
      
        <link rel="next" href="../lustmotion-contribute/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.34">
    
    
      
        <title>Remote Control API - OpenLUST</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.35f28582.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="purple" data-md-color-accent="deep-purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#remote-control-api" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="OpenLUST" class="md-header__button md-logo" aria-label="OpenLUST" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OpenLUST
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Remote Control API
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="purple" data-md-color-accent="deep-purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="purple" data-md-color-accent="deep-purple"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/openlust/docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../lustmotion-getstarted/" class="md-tabs__link">
          
  
  LUST-motion

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../lust-remote/lustremote-firmware/" class="md-tabs__link">
          
  
  LUST-Remote

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="OpenLUST" class="md-nav__button md-logo" aria-label="OpenLUST" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    OpenLUST
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/openlust/docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    LUST-motion
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            LUST-motion
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lustmotion-getstarted/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Get Started with LUST-motion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lustmotion-config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Initial Setup &amp; Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lustmotion-usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Safe Usage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lustmotion-connectivity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Connectivity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Remote Control API
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Remote Control API
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mdns" class="md-nav__link">
    <span class="md-ellipsis">
      MDNS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stateful-services" class="md-nav__link">
    <span class="md-ellipsis">
      Stateful Services
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Stateful Services">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strokeengine-control" class="md-nav__link">
    <span class="md-ellipsis">
      StrokeEngine Control
    </span>
  </a>
  
    <nav class="md-nav" aria-label="StrokeEngine Control">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#json" class="md-nav__link">
    <span class="md-ellipsis">
      JSON
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strokeengine-safety-limits" class="md-nav__link">
    <span class="md-ellipsis">
      StrokeEngine Safety Limits
    </span>
  </a>
  
    <nav class="md-nav" aria-label="StrokeEngine Safety Limits">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#heart-beat-mode" class="md-nav__link">
    <span class="md-ellipsis">
      Heart Beat Mode
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_1" class="md-nav__link">
    <span class="md-ellipsis">
      JSON
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strokeengine-environment-read-only" class="md-nav__link">
    <span class="md-ellipsis">
      StrokeEngine Environment read-only
    </span>
  </a>
  
    <nav class="md-nav" aria-label="StrokeEngine Environment read-only">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#json_2" class="md-nav__link">
    <span class="md-ellipsis">
      JSON
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mqtt" class="md-nav__link">
    <span class="md-ellipsis">
      MQTT
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strokeengine-streaming-write-only" class="md-nav__link">
    <span class="md-ellipsis">
      StrokeEngine Streaming write-only
    </span>
  </a>
  
    <nav class="md-nav" aria-label="StrokeEngine Streaming write-only">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#json_3" class="md-nav__link">
    <span class="md-ellipsis">
      JSON
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#motor-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Motor Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Motor Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#json_4" class="md-nav__link">
    <span class="md-ellipsis">
      JSON
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#websocket-raw-data-streaming" class="md-nav__link">
    <span class="md-ellipsis">
      Websocket Raw Data Streaming
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#server-sent-events" class="md-nav__link">
    <span class="md-ellipsis">
      Server Sent Events
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lustmotion-contribute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contribute
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    LUST-Remote
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            LUST-Remote
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lust-remote/lustremote-firmware/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Web Flasher
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="remote-control-api">Remote Control API</h1>
<h2 id="mdns">MDNS</h2>
<p>LUST-motion is discoverable by MDNS services und advertises a <code>stroking</code> service. This can be used to identify the device on the local network and establish connections with it. The following service texts provide further information:</p>
<table>
<thead>
<tr>
<th>Text</th>
<th>Information</th>
</tr>
</thead>
<tbody>
<tr>
<td>FirmwareVersion</td>
<td>Currently used firmware version to adjust for API versions and capabilities</td>
</tr>
<tr>
<td>DeviceID</td>
<td>Unique device ID</td>
</tr>
</tbody>
</table>
<h2 id="stateful-services">Stateful Services</h2>
<p>Stateful services offer direct control over the machine and can be reached via a RESTful API. Some stateful services are also offered through a websocket server or MQTT. All changes are internally synchronized and propagated back to all clients. Redundant messages which do not change any internal state are filtered out and not propagated.</p>
<blockquote>
<p><strong><em>⚠️ IMPORTANT:</em></strong> There is a rate limit to these updates. You should avoid more then 10 Hz, otherwise the API might become unstable and could cause a fatal crash.</p>
</blockquote>
<h3 id="strokeengine-control">StrokeEngine Control</h3>
<p>The main control API to control LUST-motion. Starts and stops the motion, changes the main parameters depth, stroke, speed and sensation. Also allows the selection of a pattern, or if the streaming interfaces should be used as input source for the motion generation. In addition it provides the possibility to override the vibration overlay with fixed costume values. If enabled, vibration commands from pattern or streaming are ignored.</p>
<blockquote>
<p>Defined in <code>StrokeEngineControlService.h</code></p>
</blockquote>
<table>
<thead>
<tr>
<th>Method</th>
<th>URL</th>
<th>Authentication</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>/rest/control</td>
<td><code>NONE_REQUIRED</code></td>
</tr>
<tr>
<td>POST</td>
<td>/rest/control</td>
<td><code>NONE_REQUIRED</code></td>
</tr>
<tr>
<td>WS</td>
<td>/ws/control</td>
<td><code>NONE_REQUIRED</code></td>
</tr>
<tr>
<td>MQTT</td>
<td>-</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Range</th>
<th>Info</th>
<th>Failure Mode</th>
</tr>
</thead>
<tbody>
<tr>
<td>command</td>
<td>string</td>
<td>{command}</td>
<td>Controls the machine like start a pattern, activate streaming or stop it. Commands are not case sensitive</td>
<td>STOP</td>
</tr>
<tr>
<td>depth</td>
<td>number</td>
<td>0.0 - <code>travel</code></td>
<td>maximum depth of the motion</td>
<td>truncated into range</td>
</tr>
<tr>
<td>stroke</td>
<td>number</td>
<td>0.0 - <code>travel</code></td>
<td>length of the stroke</td>
<td>truncated into range</td>
</tr>
<tr>
<td>rate</td>
<td>number</td>
<td>0.0 - <code>max_rate</code></td>
<td>rate in strokes per minute</td>
<td>truncated into range</td>
</tr>
<tr>
<td>sensation</td>
<td>number</td>
<td>-100.0 - +100.0</td>
<td>affects the feeling of a pattern</td>
<td>truncated into range</td>
</tr>
<tr>
<td>pattern</td>
<td>string</td>
<td>-</td>
<td>name of a pattern in the pattern array returned by <a href="#strokeengine-environment-read-only">StrokeEngine Environment API</a></td>
<td>ignored</td>
</tr>
<tr>
<td>vibration_override</td>
<td>boolean</td>
<td>true / false</td>
<td>overrides the vibration overlay with these parameters. Vibration commands from pattern or streaming will be ignored</td>
<td>false</td>
</tr>
<tr>
<td>vibration_amplitude</td>
<td>number</td>
<td>0.0 - 5.0</td>
<td>amplitude of a vibration overlay, 0.0 == off</td>
<td>truncated into range</td>
</tr>
<tr>
<td>vibration_frequency</td>
<td>number</td>
<td>10.0 - 50.0</td>
<td>frequency in HZ of the vibration overlay</td>
<td>truncated into range</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align: center;">Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">"STOP"</td>
<td>Stops the machine instantly</td>
</tr>
<tr>
<td style="text-align: center;">"retract"</td>
<td>Moves the endeffector to the far end (home position) with a safe speed</td>
</tr>
<tr>
<td style="text-align: center;">"depth"</td>
<td>Retracts the motor to the home position with the ease-in speed. This is the default state after the motor is homed.</td>
</tr>
<tr>
<td style="text-align: center;">"stroke"</td>
<td>Moves the motor to the depth-stroke position a.k.a. the start of the stroke with the ease-in speed. Whenever the parameter stroke is changed, the motor will move to the new depth-stroke.</td>
</tr>
<tr>
<td style="text-align: center;">"playpattern"</td>
<td>Starts the pattern generator and runs the pattern.</td>
</tr>
<tr>
<td style="text-align: center;">"strokestream"</td>
<td>Starts the stream input and interprets them as trapezoidal moves with 1/3 acceleration, 1/3 constant speed and 1/3 deceleration. The stream input is interpreted as relative positions on the scale [0.0 - 1.0] and mapped to [depth, depth-stroke].</td>
</tr>
<tr>
<td style="text-align: center;">"positionstream</td>
<td>Starts the stream input and interprets them as relative positions on the scale [0.0 - 1.0] and maps them to [depth, depth-stroke].</td>
</tr>
</tbody>
</table>
<h4 id="json">JSON</h4>
<pre><code class="language-JSON">{
    &quot;command&quot;: &quot;STOP&quot;,
    &quot;depth&quot;: 120.0,
    &quot;stroke&quot;: 80.5,
    &quot;rate&quot;: 30.0,
    &quot;sensation&quot;: 0.0,
    &quot;pattern&quot;: &quot;Deeper&quot;,
    &quot;vibration_override&quot;: false,
    &quot;vibration_amplitude&quot;: 0.0,
    &quot;vibration_frequency&quot;: 25.0
}
</code></pre>
<h3 id="strokeengine-safety-limits">StrokeEngine Safety Limits</h3>
<p>This API can be used to restrict the mechanical reach of the machine and limit the maximum speed attainable. These soft limits will be used to truncate any control value coming through the <a href="#strokeengine-control">Control API</a> or the streaming interface.</p>
<blockquote>
<p>Defined in <code>StrokeEngineSafetyService.h</code></p>
</blockquote>
<table>
<thead>
<tr>
<th>Method</th>
<th>URL</th>
<th>Authentication</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>/rest/safety</td>
<td><code>NONE_REQUIRED</code></td>
</tr>
<tr>
<td>POST</td>
<td>/rest/safety</td>
<td><code>NONE_REQUIRED</code></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Range</th>
<th>Info</th>
<th>Failure Mode</th>
</tr>
</thead>
<tbody>
<tr>
<td>depth_limit</td>
<td>number</td>
<td>0.0 - <code>depth</code></td>
<td>maximum depth of the motion</td>
<td>truncated into range</td>
</tr>
<tr>
<td>stroke_limit</td>
<td>number</td>
<td>0.0 - <code>depth</code></td>
<td>length of the stroke</td>
<td>truncated into range</td>
</tr>
<tr>
<td>rate_limit</td>
<td>number</td>
<td>0.5 - 600</td>
<td>maximum rate the machine is limited to</td>
<td>truncated into range</td>
</tr>
<tr>
<td>velocity_limit</td>
<td>number</td>
<td>0.0 - <code>max_velocity</code></td>
<td>velocity limit in mm/s for regular moves. Vibration is not affected by this limit</td>
<td>truncated into range</td>
</tr>
<tr>
<td>heartbeat_mode</td>
<td>number</td>
<td>0 - 1</td>
<td>selects the heartbeat mode and how to enter safestate if a client looses connection</td>
<td>1</td>
</tr>
<tr>
<td>ease_in_speed</td>
<td>number</td>
<td>0.0 - 30.0</td>
<td>velocity in mm/s to ease in changes in stroke or depth or move to predefined depths</td>
<td>truncated into range</td>
</tr>
</tbody>
</table>
<h4 id="heart-beat-mode">Heart Beat Mode</h4>
<table>
<thead>
<tr>
<th style="text-align: center;">Number</th>
<th style="text-align: center;">Heartbeat Mode</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">0</td>
<td style="text-align: center;">"none"</td>
<td>Heartbeat disabled</td>
</tr>
<tr>
<td style="text-align: center;">1</td>
<td style="text-align: center;">"any"</td>
<td>Enter safestate if one connections drops</td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td style="text-align: center;">"last"</td>
<td>Enter safestate when last connection drops</td>
</tr>
</tbody>
</table>
<p>A client can safely disconnect if the machine is in standstill and any motion input disabled.</p>
<h4 id="json_1">JSON</h4>
<pre><code class="language-JSON">{
    &quot;depth_limit&quot;: 120.0,
    &quot;stroke_limit&quot;: 80.5,
    &quot;rate_limit&quot;: 30.0,
    &quot;heartbeat_mode&quot;: 0,
    &quot;ease_in_speed&quot;: 5.0
}
</code></pre>
<h3 id="strokeengine-environment-read-only">StrokeEngine Environment <em>read-only</em></h3>
<p>This API will provide the information about the environment like maximum travel or maximum speed. This can be used by the UI to scale UI elements according to the machines real physical properties.</p>
<blockquote>
<p>Defined in <code>StrokeEngineEnvironmentService.h</code></p>
</blockquote>
<table>
<thead>
<tr>
<th>Method</th>
<th>URL</th>
<th>Authentication</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>/rest/environment</td>
<td><code>NONE_REQUIRED</code></td>
</tr>
<tr>
<td>MQTT</td>
<td>-</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Info</th>
</tr>
</thead>
<tbody>
<tr>
<td>depth</td>
<td>number</td>
<td>maximum travel of the machine. Used for depth and stroke</td>
</tr>
<tr>
<td>max_rate</td>
<td>number</td>
<td>maximum rate in FPM that the machine is capable</td>
</tr>
<tr>
<td>max_velocity</td>
<td>number</td>
<td>maximum velocity in mm/s. Given by the maximum RPM and the gearing ratio.</td>
</tr>
<tr>
<td>heartbeat_mode</td>
<td>number</td>
<td>heartbeat mode. If &gt; 0 the control message must be sent every second, regardless wether it has changed</td>
</tr>
<tr>
<td>patterns</td>
<td>array of strings</td>
<td>array of all available pattern names</td>
</tr>
<tr>
<td>valueA</td>
<td>string</td>
<td>Label of the valueA data stream</td>
</tr>
<tr>
<td>valueB</td>
<td>string</td>
<td>Label of the valueB data stream</td>
</tr>
<tr>
<td>motor</td>
<td>string</td>
<td>Which motor driver is loaded: <code>VIRTUAL</code>, <code>GENERIC_STEPPER</code>, <code>OSSM_REF_BOARD_V2</code> or <code>IHSV_SERVO_V6</code></td>
</tr>
</tbody>
</table>
<h4 id="json_2">JSON</h4>
<pre><code class="language-JSON">{
    &quot;depth&quot;: 150.0,
    &quot;max_rate&quot;: 30.0,
    &quot;heartbeat_mode&quot;: 1,
    &quot;pattern&quot;: [&quot;Depth Adjustment&quot;, &quot;Streaming&quot;, &quot;Pounding or Teasing&quot;, &quot;Robo Stroke&quot;],
    &quot;valueA&quot; : &quot;Real Position&quot;,
    &quot;valueB&quot; : &quot;Torque&quot;,
    &quot;motor&quot; : &quot;IHSV_SERVO_V6&quot;
}
</code></pre>
<h4 id="mqtt">MQTT</h4>
<p>Environment messages are always send with the flag <code>retain</code> and QoS = 1 to make it available for all new consumers. Environment messages are sent out whenever it connects to the broker or the topic is reconfigured. Additionally a MQTT client may request an environment JSON by sending a payload with "environment" to the environment topic.</p>
<h3 id="strokeengine-streaming-write-only">StrokeEngine Streaming <em>write-only</em></h3>
<p>Instead of pattern the motion commands can be provided via this streaming interface, too. Messages are queued up with a queue length of 5. Writing to a full queue will result in the message being discarded. An empty queue will stop the motion. Changing <code>command</code> in the <a href="#strokeengine-control">Control API</a> will erase the queue. That way streaming always starts with a fresh queue. This service is write only. Changes won't propagate to other clients and a GET request will return an empty JSON.</p>
<blockquote>
<p>Defined in <code>StrokeEngineStreamingService.h</code></p>
</blockquote>
<table>
<thead>
<tr>
<th>Method</th>
<th>URL</th>
<th>Authentication</th>
</tr>
</thead>
<tbody>
<tr>
<td>POST</td>
<td>/rest/streaming</td>
<td><code>NONE_REQUIRED</code></td>
</tr>
<tr>
<td>WS</td>
<td>/ws/streaming</td>
<td><code>NONE_REQUIRED</code></td>
</tr>
<tr>
<td>MQTT</td>
<td>-</td>
<td>/N/A</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Range</th>
<th>Info</th>
<th>Failure Mode</th>
</tr>
</thead>
<tbody>
<tr>
<td>stroke</td>
<td>number</td>
<td>0.0 - 1.0</td>
<td>relative length of the stroke, mapped to the true stroke length set by the control message</td>
<td>truncated into range</td>
</tr>
<tr>
<td>duration</td>
<td>number</td>
<td>0.0 - 60.0</td>
<td>duration of the stroke in seconds</td>
<td>truncated into range</td>
</tr>
<tr>
<td>vibration_amplitude</td>
<td>number</td>
<td>0.0 - 5.0</td>
<td>amplitude of a vibration overlay, 0.0 == off</td>
<td>truncated into range or 0.0</td>
</tr>
<tr>
<td>vibration_frequency</td>
<td>number</td>
<td>10.0 - 50.0</td>
<td>frequency in HZ of the vibration overlay</td>
<td>truncated into range</td>
</tr>
</tbody>
</table>
<h4 id="json_3">JSON</h4>
<pre><code class="language-JSON">{
    &quot;stroke&quot;: 0.85,
    &quot;duration&quot;: 2.21,
    &quot;vibration_amplitude&quot;: 0.0,
    &quot;vibration_frequency&quot;: 25.0
}
</code></pre>
<h3 id="motor-configuration">Motor Configuration</h3>
<p>This REST endpoint configures the motor driver and important parameters during runtime. It starts with the <code>VIRTUAL</code> driver by default. The available driver depend on the hardware and build target.</p>
<blockquote>
<p>Defined in <code>MotorConfigurationService.h</code></p>
</blockquote>
<table>
<thead>
<tr>
<th>Method</th>
<th>URL</th>
<th>Authentication</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>/rest/motorConfig</td>
<td><code>IS_ADMIN</code></td>
</tr>
<tr>
<td>POST</td>
<td>/rest/motorConfig</td>
<td><code>IS_ADMIN</code></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Info</th>
</tr>
</thead>
<tbody>
<tr>
<td>driver</td>
<td>string</td>
<td>must match one of the available motor drivers <code>VIRTUAL</code>, <code>GENERIC_STEPPER</code>, <code>OSSM_REF_BOARD_V2</code> or <code>IHSV_SERVO_V6</code></td>
</tr>
<tr>
<td>driver_list</td>
<td>array of strings</td>
<td>A list of all available motor drivers for this particular build / board</td>
</tr>
<tr>
<td>steps_per_rev</td>
<td>number</td>
<td>How many steps the motor turns per revolution</td>
</tr>
<tr>
<td>max_rpm</td>
<td>number</td>
<td>Maximum RPM of the motor</td>
</tr>
<tr>
<td>max_acceleration</td>
<td>number</td>
<td>Maximum acceleration in [mm/s²]</td>
</tr>
<tr>
<td>pulley_teeth</td>
<td>number</td>
<td>Number of teeth on the pulley assuming a GT2 belt</td>
</tr>
<tr>
<td>invert_direction</td>
<td>boolean</td>
<td>can be used to change the direction of the machine</td>
</tr>
<tr>
<td>measure_travel</td>
<td>boolean</td>
<td>if set to <code>true</code> will initiate a measurement, if it is within the capabilities of the driver</td>
</tr>
<tr>
<td>home</td>
<td>boolean</td>
<td>if set to <code>true</code> it will initiate a homing cycle</td>
</tr>
<tr>
<td>travel</td>
<td>number</td>
<td>The mechanical travel from one endstop to the other</td>
</tr>
<tr>
<td>keepout</td>
<td>number</td>
<td>Soft endstop distance from hard endstop away. In mm on both sides</td>
</tr>
<tr>
<td>sensorless_trigger</td>
<td>number</td>
<td>Trigger value for sensorless homing in % of rated torque or rated current</td>
</tr>
</tbody>
</table>
<h4 id="json_4">JSON</h4>
<pre><code class="language-JSON">{
    &quot;driver&quot;: &quot;IHSV_SERVO_V6&quot;,
    &quot;driver_list&quot;: [&quot;VIRTUAL&quot;, &quot;GENERIC_STEPPER&quot;, &quot;OSSM_REF_BOARD_V2&quot;, &quot;IHSV_SERVO_V6&quot;],
    &quot;steps_per_rev&quot;: 2000,
    &quot;max_rpm&quot;: 3000,
    &quot;max_acceleration&quot;: 100000,
    &quot;pulley_teeth&quot;: 20,
    &quot;invert_direction&quot;: false,
    &quot;measure_travel&quot;: false,
    &quot;home&quot;: false,
    &quot;travel&quot;: 160,
    &quot;keepout&quot;: 5.0,
    &quot;sensorless_trigger&quot;: 20,
}
</code></pre>
<h2 id="websocket-raw-data-streaming">Websocket Raw Data Streaming</h2>
<blockquote>
<p>Defined in <code>WebSocketRawDataStreaming.h</code></p>
</blockquote>
<p>A constant stream of position, velocity and other parameters are available on a websocket connection. These values are send in a binary CBOR format and contain an array of several data points for a given time slot. The binary format is chosen to save bandwidth and typically 5 data points are aggregated into one message to reduce the message rate. This can be used as a direct user feedback of what is happening with the machine.</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>URL</th>
<th>Authentication</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>/ws/rawPosition</td>
<td><code>NONE_REQUIRED</code></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Info</th>
</tr>
</thead>
<tbody>
<tr>
<td>time</td>
<td>unsigned int</td>
<td>time in milliseconds since device started</td>
</tr>
<tr>
<td>position</td>
<td>float</td>
<td>the real-time position in [mm]</td>
</tr>
<tr>
<td>speed</td>
<td>float</td>
<td>the real-time velocity in [mm/s]</td>
</tr>
<tr>
<td>valueA</td>
<td>float</td>
<td>An analog value the motor driver can send. e.g. current, force or torque</td>
</tr>
<tr>
<td>valueB</td>
<td>float</td>
<td>An analog value the motor driver can send. e.g. current, force or torque</td>
</tr>
</tbody>
</table>
<h2 id="server-sent-events">Server Sent Events</h2>
<p>The current motor state is updated every 500ms via SSE events. The following events are available:</p>
<table>
<thead>
<tr>
<th>Event</th>
<th>Message</th>
<th>Info</th>
</tr>
</thead>
<tbody>
<tr>
<td>motor_homed</td>
<td>"true" / "false"</td>
<td>Wether the motor is currently homed or not</td>
</tr>
<tr>
<td>motor_error</td>
<td>"true" / "false"</td>
<td>Wether the motor is currently in error state or not</td>
</tr>
</tbody>
</table>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "toc.follow", "toc.integrate", "navigation.top", "content.code.copy", "search.highlight"], "search": "../assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.56dfad97.min.js"></script>
      
    
  </body>
</html>